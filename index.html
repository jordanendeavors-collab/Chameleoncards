<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Chameleon Studios‚Ñ¢ | Create Stunning Cards & Invites</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü¶é</text></svg>">
    <style>
        :root{--bg:#060609;--surface:#0e0e14;--card:#14141c;--elevated:#1c1c28;--border:rgba(255,255,255,0.06);--text:#fafafa;--text-dim:#a1a1aa;--text-muted:#52525b;--chameleon:#10b981;--purple:#8b5cf6;--pink:#ec4899;--success:#22c55e;--error:#ef4444;--radius-sm:8px;--radius-md:12px;--radius-lg:20px;--radius-xl:28px}
        *{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;line-height:1.5}
        @keyframes shimmer{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
        @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
        @keyframes spin{to{transform:rotate(360deg)}}
        @keyframes reveal{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
        .gradient-brand{background:linear-gradient(135deg,var(--chameleon),var(--purple),var(--pink));background-size:300% 300%;animation:shimmer 8s ease infinite}
        .gradient-text{background:linear-gradient(135deg,#34d399,var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
        header{position:sticky;top:0;z-index:100;background:rgba(6,6,9,0.95);backdrop-filter:blur(20px);border-bottom:1px solid var(--border)}
        .header-inner{max-width:1600px;margin:0 auto;padding:14px 24px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px}
        .logo{display:flex;align-items:center;gap:12px;text-decoration:none;cursor:pointer}
        .logo-icon{width:48px;height:48px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:26px;position:relative}
        .logo-icon::before{content:'';position:absolute;inset:0;border-radius:inherit;background:linear-gradient(135deg,var(--chameleon),var(--purple))}
        .logo-icon span{position:relative;z-index:1}
        .logo-text h1{font-size:22px;font-weight:800}.logo-text p{font-size:11px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.5px}
        .nav-tabs{display:flex;gap:4px;background:var(--surface);padding:5px;border-radius:12px;border:1px solid var(--border)}
        .nav-tab{padding:10px 18px;border:none;background:transparent;color:var(--text-dim);font-size:13px;font-weight:600;cursor:pointer;border-radius:8px;transition:all 0.2s}
        .nav-tab:hover{color:var(--text);background:var(--card)}.nav-tab.active{background:var(--chameleon);color:#000}
        main{max-width:1600px;margin:0 auto;padding:24px}.section{display:none}.section.active{display:block;animation:reveal 0.4s ease}
        .workflow-bar{display:flex;justify-content:center;gap:8px;margin-bottom:32px;flex-wrap:wrap}
        .workflow-step{display:flex;align-items:center;gap:10px;padding:10px 20px;background:var(--card);border:1px solid var(--border);border-radius:50px;font-size:13px;color:var(--text-muted);transition:all 0.3s}
        .workflow-step.active{background:rgba(16,185,129,0.15);border-color:var(--chameleon);color:var(--chameleon)}
        .workflow-step.done{background:rgba(34,197,94,0.15);border-color:var(--success);color:var(--success)}
        .workflow-num{width:24px;height:24px;border-radius:50%;background:currentColor;color:var(--bg);display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700}
        .panel{background:var(--card);border:1px solid var(--border);border-radius:var(--radius-xl);overflow:hidden}
        .panel-header{padding:20px 24px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px}
        .panel-title{font-size:18px;font-weight:700;display:flex;align-items:center;gap:10px}.panel-body{padding:24px}
        .badge{font-size:10px;font-weight:700;padding:4px 10px;border-radius:20px;text-transform:uppercase}.badge-new{background:var(--chameleon);color:#000}
        .two-col{display:grid;grid-template-columns:1fr;gap:24px}@media(min-width:1100px){.two-col{grid-template-columns:1fr 1fr}}
        .card-types-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(90px,1fr));gap:10px;margin-bottom:24px}
        .card-type{background:var(--surface);border:2px solid var(--border);border-radius:var(--radius-md);padding:12px 6px;text-align:center;cursor:pointer;transition:all 0.3s}
        .card-type:hover{border-color:rgba(255,255,255,0.12);transform:translateY(-3px)}.card-type.active{border-color:var(--chameleon);background:rgba(16,185,129,0.1)}
        .card-type .icon{font-size:26px;margin-bottom:4px;display:block}.card-type .name{font-size:10px;font-weight:600}
        .canvas-area{background:var(--surface);border-radius:var(--radius-lg);overflow:hidden;margin-bottom:20px;position:relative}
        #drawCanvas{width:100%;aspect-ratio:5/7;display:block;cursor:crosshair;touch-action:none;background:#f8f5f0}
        .canvas-hint{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;pointer-events:none;text-align:center;padding:20px;transition:opacity 0.3s}
        .canvas-hint.hidden{opacity:0}.canvas-hint .icon{font-size:56px;margin-bottom:12px;animation:float 3s ease-in-out infinite}.canvas-hint .text{font-size:16px;color:#666}
        .tools-row{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:16px}
        .tool-btn{padding:10px 14px;border-radius:var(--radius-sm);border:1px solid var(--border);background:var(--surface);color:var(--text);font-size:12px;font-weight:500;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;gap:5px}
        .tool-btn:hover{background:var(--elevated);transform:translateY(-1px)}.tool-btn.active{background:var(--chameleon);border-color:var(--chameleon);color:#000}
        .colors-row{display:flex;gap:6px;flex-wrap:wrap;align-items:center;margin-bottom:16px}
        .color-swatch{width:28px;height:28px;border-radius:6px;cursor:pointer;border:2px solid transparent;transition:all 0.15s}
        .color-swatch:hover{transform:scale(1.15)}.color-swatch.active{border-color:#fff;box-shadow:0 0 12px rgba(255,255,255,0.4)}
        .slider-row{display:flex;align-items:center;gap:12px;margin-bottom:16px}.slider-row label{font-size:12px;font-weight:600;color:var(--text-dim);min-width:50px}
        .slider-row input[type="range"]{flex:1;accent-color:var(--chameleon)}.slider-row span{font-size:12px;color:var(--text-muted);min-width:35px}
        .style-section{margin-bottom:24px}.style-label{font-size:13px;font-weight:600;color:var(--text-dim);margin-bottom:12px;text-transform:uppercase;letter-spacing:0.5px}
        .style-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}@media(max-width:700px){.style-grid{grid-template-columns:repeat(2,1fr)}}
        .style-option{background:var(--surface);border:2px solid var(--border);border-radius:var(--radius-md);padding:14px 10px;text-align:center;cursor:pointer;transition:all 0.3s}
        .style-option:hover{border-color:rgba(255,255,255,0.12);transform:translateY(-2px)}.style-option.active{border-color:var(--chameleon);background:rgba(16,185,129,0.1)}
        .style-option .icon{font-size:28px;margin-bottom:6px;display:block}.style-option .name{font-size:12px;font-weight:600}
        .texture-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:8px}
        .texture-btn{aspect-ratio:1;border:2px solid var(--border);border-radius:var(--radius-sm);cursor:pointer;transition:all 0.2s;position:relative;overflow:hidden}
        .texture-btn:hover{border-color:rgba(255,255,255,0.12);transform:scale(1.05)}.texture-btn.active{border-color:var(--chameleon)}
        .texture-btn .lbl{position:absolute;bottom:2px;left:0;right:0;font-size:8px;text-align:center;color:var(--text-muted)}
        .tex-none{background:#f8f5f0}.tex-linen{background:#faf0e6}.tex-kraft{background:#c9a66b}.tex-marble{background:linear-gradient(135deg,#f5f5f5,#e0e0e0,#f0f0f0)}.tex-wood{background:linear-gradient(90deg,#deb887 0%,#d2a06d 50%,#deb887 100%)}.tex-dark{background:#1a1a2e}
        .card-preview-container{perspective:1200px;margin-bottom:24px}
        .card-preview{width:100%;max-width:360px;margin:0 auto;aspect-ratio:5/7;position:relative;transform-style:preserve-3d;transition:transform 0.8s cubic-bezier(0.4,0,0.2,1)}
        .card-preview.flipped{transform:rotateY(180deg)}
        .card-front,.card-back{position:absolute;inset:0;backface-visibility:hidden;border-radius:var(--radius-lg);overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.4)}
        .card-back{transform:rotateY(180deg);background:#f8f5f0}.card-front{background:#f8f5f0}.card-front canvas{width:100%;height:100%;display:block}
        .text-editor{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-md);padding:16px;margin-bottom:16px}
        .text-editor-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}.text-editor-title{font-size:14px;font-weight:600}
        .text-input{width:100%;padding:12px;background:var(--bg);border:1px solid var(--border);border-radius:var(--radius-sm);color:var(--text);font-size:14px;resize:none;margin-bottom:12px}.text-input:focus{outline:none;border-color:var(--chameleon)}
        .text-controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
        .text-ctrl-btn{padding:8px 12px;background:var(--bg);border:1px solid var(--border);border-radius:var(--radius-sm);color:var(--text);font-size:12px;cursor:pointer;transition:all 0.2s}
        .text-ctrl-btn:hover{background:var(--elevated)}.text-ctrl-btn.active{background:var(--chameleon);color:#000;border-color:var(--chameleon)}
        .font-select{padding:8px 12px;background:var(--bg);border:1px solid var(--border);border-radius:var(--radius-sm);color:var(--text);font-size:12px;cursor:pointer}
        .text-block{position:absolute;cursor:move;padding:8px 12px;border:2px dashed transparent;border-radius:4px;transition:border-color 0.2s;user-select:none}
        .text-block:hover,.text-block.selected{border-color:var(--chameleon)}.text-block.selected{box-shadow:0 0 0 3px rgba(16,185,129,0.3)}
        .generate-btn{width:100%;padding:16px;border:none;border-radius:var(--radius-md);font-size:16px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;transition:all 0.3s;color:#000;background:linear-gradient(135deg,var(--chameleon),#34d399)}
        .generate-btn:hover{transform:translateY(-2px);box-shadow:0 12px 40px rgba(16,185,129,0.4)}.generate-btn:disabled{opacity:0.5;cursor:not-allowed;transform:none}
        .spinner{width:20px;height:20px;border:3px solid rgba(0,0,0,0.2);border-top-color:#000;border-radius:50%;animation:spin 0.8s linear infinite}
        .actions-row{display:flex;gap:10px;flex-wrap:wrap}
        .action-btn{flex:1;min-width:100px;padding:12px 16px;border-radius:var(--radius-md);border:1px solid var(--border);background:var(--surface);color:var(--text);font-size:13px;font-weight:600;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;justify-content:center;gap:6px}
        .action-btn:hover{background:var(--elevated);transform:translateY(-2px)}.action-btn.primary{background:var(--success);border-color:var(--success);color:#fff}
        .gallery-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:20px}
        .gallery-card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius-lg);overflow:hidden;cursor:pointer;transition:all 0.3s}
        .gallery-card:hover{transform:translateY(-8px);box-shadow:0 20px 60px rgba(0,0,0,0.3);border-color:var(--chameleon)}
        .gallery-card-image{aspect-ratio:5/7;position:relative;overflow:hidden}.gallery-card-image canvas,.gallery-card-image img{width:100%;height:100%;object-fit:cover}
        .gallery-card-info{padding:14px}.gallery-card-title{font-size:14px;font-weight:600;margin-bottom:4px}.gallery-card-meta{font-size:11px;color:var(--text-muted)}
        .templates-hero{text-align:center;margin-bottom:40px}.templates-hero h2{font-size:28px;font-weight:800;margin-bottom:12px}.templates-hero p{color:var(--text-dim);max-width:500px;margin:0 auto}
        .template-filters{display:flex;gap:8px;justify-content:center;margin-bottom:32px;flex-wrap:wrap}
        .filter-btn{padding:10px 20px;background:var(--surface);border:1px solid var(--border);border-radius:50px;color:var(--text-dim);font-size:13px;font-weight:500;cursor:pointer;transition:all 0.2s}
        .filter-btn:hover{color:var(--text);background:var(--card)}.filter-btn.active{background:var(--chameleon);border-color:var(--chameleon);color:#000}
        .toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%) translateY(100px);padding:14px 24px;background:var(--elevated);border:1px solid var(--border);border-radius:12px;font-size:14px;font-weight:500;z-index:1000;opacity:0;transition:all 0.3s;box-shadow:0 12px 40px rgba(0,0,0,0.4)}
        .toast.show{opacity:1;transform:translateX(-50%) translateY(0)}.toast.error{border-color:var(--error)}
        footer{text-align:center;padding:24px;border-top:1px solid var(--border);color:var(--text-muted);font-size:12px}
        @media(max-width:600px){.header-inner{padding:12px 16px}main{padding:16px}.panel-body{padding:16px}}
    </style>
</head>
<body>
    <header><div class="header-inner"><a href="#" class="logo" onclick="showSection('create')"><div class="logo-icon gradient-brand"><span>ü¶é</span></div><div class="logo-text"><h1 class="gradient-text">Chameleon Studios</h1><p>Cards That Captivate‚Ñ¢</p></div></a><nav class="nav-tabs"><button class="nav-tab active" data-section="create" onclick="showSection('create')">‚ú® Create</button><button class="nav-tab" data-section="templates" onclick="showSection('templates')">üìã Templates</button><button class="nav-tab" data-section="saved" onclick="showSection('saved')">üíæ Saved</button></nav></div></header>
    <main>
        <section id="section-create" class="section active">
            <div class="workflow-bar"><div class="workflow-step active" id="step1"><span class="workflow-num">1</span><span>Choose Card</span></div><div class="workflow-step" id="step2"><span class="workflow-num">2</span><span>Draw & Style</span></div><div class="workflow-step" id="step3"><span class="workflow-num">3</span><span>Add Text</span></div><div class="workflow-step" id="step4"><span class="workflow-num">4</span><span>Download</span></div></div>
            <div class="two-col">
                <div class="panel"><div class="panel-header"><div class="panel-title"><span>üé®</span> Design Your Card</div><span class="badge badge-new">AI Styles</span></div><div class="panel-body">
                    <div class="style-label">1. Choose Card Type</div><div class="card-types-grid" id="cardTypes"></div>
                    <div class="style-label">2. Draw Your Design</div><div class="canvas-area"><canvas id="drawCanvas"></canvas><div class="canvas-hint" id="canvasHint"><span class="icon">‚úèÔ∏è</span><span class="text">Draw or sketch here</span></div></div>
                    <div class="tools-row"><button class="tool-btn active" data-tool="brush" onclick="setTool('brush')">üñåÔ∏è Brush</button><button class="tool-btn" data-tool="pencil" onclick="setTool('pencil')">‚úèÔ∏è Pencil</button><button class="tool-btn" data-tool="marker" onclick="setTool('marker')">üñçÔ∏è Marker</button><button class="tool-btn" data-tool="eraser" onclick="setTool('eraser')">üßΩ Eraser</button><button class="tool-btn" onclick="clearCanvas()">üóëÔ∏è Clear</button></div>
                    <div class="colors-row"><div class="color-swatch active" style="background:#000" data-color="#000000" onclick="setColor('#000000')"></div><div class="color-swatch" style="background:#fff;border:1px solid #333" data-color="#ffffff" onclick="setColor('#ffffff')"></div><div class="color-swatch" style="background:#ef4444" data-color="#ef4444" onclick="setColor('#ef4444')"></div><div class="color-swatch" style="background:#f97316" data-color="#f97316" onclick="setColor('#f97316')"></div><div class="color-swatch" style="background:#eab308" data-color="#eab308" onclick="setColor('#eab308')"></div><div class="color-swatch" style="background:#22c55e" data-color="#22c55e" onclick="setColor('#22c55e')"></div><div class="color-swatch" style="background:#3b82f6" data-color="#3b82f6" onclick="setColor('#3b82f6')"></div><div class="color-swatch" style="background:#8b5cf6" data-color="#8b5cf6" onclick="setColor('#8b5cf6')"></div><div class="color-swatch" style="background:#ec4899" data-color="#ec4899" onclick="setColor('#ec4899')"></div><input type="color" id="customColor" value="#10b981" style="width:28px;height:28px;border:none;border-radius:6px;cursor:pointer" onchange="setColor(this.value)"></div>
                    <div class="slider-row"><label>Size</label><input type="range" id="brushSize" min="1" max="40" value="6" oninput="setBrushSize(this.value)"><span id="sizeVal">6px</span></div>
                    <div class="style-section"><div class="style-label">3. Choose AI Style</div><div class="style-grid"><div class="style-option active" data-style="comic" onclick="setStyle('comic')"><span class="icon">üí•</span><span class="name">Comic</span></div><div class="style-option" data-style="outdoor" onclick="setStyle('outdoor')"><span class="icon">üå≤</span><span class="name">Outdoor</span></div><div class="style-option" data-style="sketch" onclick="setStyle('sketch')"><span class="icon">‚úèÔ∏è</span><span class="name">Sketch</span></div><div class="style-option" data-style="pro" onclick="setStyle('pro')"><span class="icon">üèÜ</span><span class="name">Pro</span></div></div></div>
                    <div class="style-section"><div class="style-label">4. Background Texture</div><div class="texture-grid"><div class="texture-btn tex-none active" data-texture="none" onclick="setTexture('none')"><span class="lbl">None</span></div><div class="texture-btn tex-linen" data-texture="linen" onclick="setTexture('linen')"><span class="lbl">Linen</span></div><div class="texture-btn tex-kraft" data-texture="kraft" onclick="setTexture('kraft')"><span class="lbl">Kraft</span></div><div class="texture-btn tex-marble" data-texture="marble" onclick="setTexture('marble')"><span class="lbl">Marble</span></div><div class="texture-btn tex-wood" data-texture="wood" onclick="setTexture('wood')"><span class="lbl">Wood</span></div><div class="texture-btn tex-dark" data-texture="dark" onclick="setTexture('dark')"><span class="lbl">Dark</span></div></div></div>
                    <button class="generate-btn" id="generateBtn" onclick="generateCard()"><span>ü¶é</span><span>Apply AI Style</span></button>
                </div></div>
                <div class="panel"><div class="panel-header"><div class="panel-title"><span>üñºÔ∏è</span> Card Preview</div><button class="tool-btn" onclick="flipCard()">üîÑ Flip</button></div><div class="panel-body">
                    <div class="card-preview-container"><div class="card-preview" id="cardPreview"><div class="card-front" id="cardFront"><canvas id="previewCanvas"></canvas><div id="textLayer" style="position:absolute;inset:0;pointer-events:none;"></div></div><div class="card-back"><div style="padding:24px;text-align:center;height:100%;display:flex;flex-direction:column;justify-content:flex-end;"><p style="color:#666;font-size:12px;">Made with ‚ù§Ô∏è using</p><p style="color:#333;font-weight:700;">Chameleon Studios‚Ñ¢</p></div></div></div></div>
                    <div class="text-editor"><div class="text-editor-header"><span class="text-editor-title">‚úçÔ∏è Add Text</span><button class="tool-btn" onclick="addTextBlock()">+ Add Text</button></div><textarea class="text-input" id="textInput" rows="2" placeholder="Type your message..."></textarea><div class="text-controls"><select class="font-select" id="fontSelect" onchange="updateTextStyle()"><option value="Georgia">Georgia</option><option value="Arial">Arial</option><option value="Times New Roman">Times</option><option value="Courier New">Courier</option><option value="Comic Sans MS">Comic Sans</option><option value="Impact">Impact</option></select><button class="text-ctrl-btn" id="boldBtn" onclick="toggleBold()"><strong>B</strong></button><button class="text-ctrl-btn" id="italicBtn" onclick="toggleItalic()"><em>I</em></button><input type="color" id="textColor" value="#000000" style="width:32px;height:32px;border:none;border-radius:4px;cursor:pointer" onchange="updateTextStyle()"><button class="text-ctrl-btn" onclick="changeTextSize(-2)">A-</button><span id="textSizeDisplay" style="font-size:12px;color:var(--text-dim)">24px</span><button class="text-ctrl-btn" onclick="changeTextSize(2)">A+</button></div></div>
                    <div class="actions-row"><button class="action-btn" onclick="downloadCard()">‚¨áÔ∏è Download</button><button class="action-btn" onclick="window.print()">üñ®Ô∏è Print</button><button class="action-btn primary" onclick="saveCard()">üíæ Save</button></div>
                </div></div>
            </div>
        </section>
        <section id="section-templates" class="section"><div class="templates-hero"><h2>üìã Ready-to-Use Templates</h2><p>Start with a professional template and customize to your style.</p></div><div class="template-filters"><button class="filter-btn active" data-filter="all">All</button><button class="filter-btn" data-filter="birthday">üéÇ Birthday</button><button class="filter-btn" data-filter="wedding">üíí Wedding</button><button class="filter-btn" data-filter="thankyou">üíö Thank You</button><button class="filter-btn" data-filter="invite">üéâ Invitation</button></div><div class="gallery-grid" id="templatesGrid"></div></section>
        <section id="section-saved" class="section"><div class="templates-hero"><h2>üíæ Your Saved Cards</h2><p>All your creations stored locally.</p></div><div id="savedGrid" class="gallery-grid"></div></section>
    </main>
    <footer><p><strong>Chameleon Studios‚Ñ¢</strong> by Stellar Studios ‚Ä¢ Cards That Captivate‚Ñ¢ ‚Ä¢ 100% Offline</p></footer>
    <div class="toast" id="toast"></div>
    <script>
    (function(){
        const CARD_TYPES=[{id:'birthday',name:'Birthday',icon:'üéÇ',color:'#f43f5e'},{id:'wedding',name:'Wedding',icon:'üíí',color:'#ec4899'},{id:'invite',name:'Invite',icon:'üéâ',color:'#8b5cf6'},{id:'thankyou',name:'Thanks',icon:'üíö',color:'#10b981'},{id:'holiday',name:'Holiday',icon:'üéÑ',color:'#ef4444'},{id:'congrats',name:'Congrats',icon:'üèÜ',color:'#f59e0b'},{id:'baby',name:'Baby',icon:'üë∂',color:'#06b6d4'},{id:'grad',name:'Grad',icon:'üéì',color:'#6366f1'}];
        const TEXTURES={none:'#f8f5f0',linen:'#faf0e6',kraft:'#c9a66b',marble:'#f5f5f5',wood:'#deb887',dark:'#1a1a2e'};
        let canvas,ctx,previewCanvas,previewCtx,isDrawing=false,hasDrawn=false,currentTool='brush',currentColor='#000000',brushSize=6,selectedCardType=null,selectedStyle='comic',selectedTexture='none',textBlocks=[],selectedTextBlock=null,textSize=24,isBold=false,isItalic=false,savedCards=[];
        document.addEventListener('DOMContentLoaded',()=>{initCardTypes();initCanvas();initPreview();loadSaved();initTemplates();});
        function initCardTypes(){document.getElementById('cardTypes').innerHTML=CARD_TYPES.map(t=>'<div class="card-type" data-type="'+t.id+'" onclick="selectCardType(\''+t.id+'\')"><span class="icon">'+t.icon+'</span><span class="name">'+t.name+'</span></div>').join('');}
        function initCanvas(){canvas=document.getElementById('drawCanvas');ctx=canvas.getContext('2d',{willReadFrequently:true});const w=canvas.parentElement.offsetWidth;canvas.width=w*2;canvas.height=w*1.4*2;canvas.style.width=w+'px';canvas.style.height=(w*1.4)+'px';ctx.fillStyle=TEXTURES[selectedTexture];ctx.fillRect(0,0,canvas.width,canvas.height);ctx.lineCap='round';ctx.lineJoin='round';canvas.addEventListener('mousedown',startDraw);canvas.addEventListener('mousemove',draw);canvas.addEventListener('mouseup',endDraw);canvas.addEventListener('mouseleave',endDraw);canvas.addEventListener('touchstart',e=>{e.preventDefault();startDraw(e.touches[0]);});canvas.addEventListener('touchmove',e=>{e.preventDefault();draw(e.touches[0]);});canvas.addEventListener('touchend',endDraw);}
        function initPreview(){previewCanvas=document.getElementById('previewCanvas');previewCtx=previewCanvas.getContext('2d');previewCanvas.width=800;previewCanvas.height=1120;previewCtx.fillStyle=TEXTURES[selectedTexture];previewCtx.fillRect(0,0,previewCanvas.width,previewCanvas.height);}
        function getPos(e){const r=canvas.getBoundingClientRect();return{x:(e.clientX-r.left)*(canvas.width/r.width),y:(e.clientY-r.top)*(canvas.height/r.height)};}
        function startDraw(e){isDrawing=true;const p=getPos(e);ctx.beginPath();ctx.moveTo(p.x,p.y);if(!hasDrawn){hasDrawn=true;document.getElementById('canvasHint').classList.add('hidden');updateWorkflow(2);}}
        function draw(e){if(!isDrawing)return;const p=getPos(e),s=brushSize*(canvas.width/canvas.offsetWidth);ctx.globalCompositeOperation=currentTool==='eraser'?'destination-out':'source-over';ctx.strokeStyle=currentTool==='eraser'?'rgba(0,0,0,1)':currentColor;ctx.lineWidth=currentTool==='pencil'?s*0.5:currentTool==='marker'?s*1.5:s;ctx.globalAlpha=currentTool==='pencil'?0.7:currentTool==='marker'?0.5:1;ctx.lineTo(p.x,p.y);ctx.stroke();ctx.beginPath();ctx.moveTo(p.x,p.y);}
        function endDraw(){isDrawing=false;ctx.globalAlpha=1;ctx.globalCompositeOperation='source-over';}
        window.setTool=t=>{currentTool=t;document.querySelectorAll('.tool-btn[data-tool]').forEach(b=>b.classList.toggle('active',b.dataset.tool===t));};
        window.setColor=c=>{currentColor=c;document.querySelectorAll('.color-swatch').forEach(s=>s.classList.toggle('active',s.dataset.color===c));};
        window.setBrushSize=s=>{brushSize=parseInt(s);document.getElementById('sizeVal').textContent=s+'px';};
        window.clearCanvas=()=>{ctx.fillStyle=TEXTURES[selectedTexture];ctx.fillRect(0,0,canvas.width,canvas.height);hasDrawn=false;document.getElementById('canvasHint').classList.remove('hidden');toast('Canvas cleared');};
        window.selectCardType=t=>{selectedCardType=t;document.querySelectorAll('.card-type').forEach(c=>c.classList.toggle('active',c.dataset.type===t));toast('Selected: '+CARD_TYPES.find(x=>x.id===t).name);};
        window.setStyle=s=>{selectedStyle=s;document.querySelectorAll('.style-option').forEach(o=>o.classList.toggle('active',o.dataset.style===s));};
        window.setTexture=t=>{selectedTexture=t;document.querySelectorAll('.texture-btn').forEach(b=>b.classList.toggle('active',b.dataset.texture===t));const d=ctx.getImageData(0,0,canvas.width,canvas.height);ctx.fillStyle=TEXTURES[t];ctx.fillRect(0,0,canvas.width,canvas.height);ctx.putImageData(d,0,0);};
        window.generateCard=()=>{if(!hasDrawn){toast('Draw something first!',true);return;}const btn=document.getElementById('generateBtn');btn.disabled=true;btn.innerHTML='<div class="spinner"></div> Processing...';setTimeout(()=>{previewCtx.fillStyle=TEXTURES[selectedTexture];previewCtx.fillRect(0,0,previewCanvas.width,previewCanvas.height);previewCtx.drawImage(canvas,0,0,previewCanvas.width,previewCanvas.height);applyStyle(previewCtx,previewCanvas,selectedStyle);btn.disabled=false;btn.innerHTML='<span>ü¶é</span><span>Apply AI Style</span>';updateWorkflow(3);toast('‚ú® Style applied!');},800);};
        function applyStyle(ctx,cvs,style){const img=ctx.getImageData(0,0,cvs.width,cvs.height),d=img.data;if(style==='comic'){for(let i=0;i<d.length;i+=4){d[i]=Math.floor(d[i]/64)*85;d[i+1]=Math.floor(d[i+1]/64)*85;d[i+2]=Math.floor(d[i+2]/64)*85;}ctx.putImageData(img,0,0);ctx.globalAlpha=0.1;for(let y=0;y<cvs.height;y+=12)for(let x=0;x<cvs.width;x+=12)if((x+y)%24===0){ctx.fillStyle='#000';ctx.beginPath();ctx.arc(x,y,3,0,Math.PI*2);ctx.fill();}ctx.globalAlpha=1;}else if(style==='outdoor'){for(let i=0;i<d.length;i+=4){d[i]=clamp(d[i]*0.95+15);d[i+1]=clamp(d[i+1]*1.1);d[i+2]=clamp(d[i+2]*0.75);}ctx.putImageData(img,0,0);}else if(style==='sketch'){for(let i=0;i<d.length;i+=4){const g=d[i]*0.3+d[i+1]*0.59+d[i+2]*0.11;d[i]=d[i+1]=d[i+2]=clamp(((g-128)*1.4)+128);}ctx.putImageData(img,0,0);ctx.strokeStyle='rgba(0,0,0,0.08)';ctx.lineWidth=1;for(let i=0;i<150;i++){const x=Math.random()*cvs.width,y=Math.random()*cvs.height,l=30+Math.random()*50,a=Math.random()*Math.PI;ctx.beginPath();ctx.moveTo(x,y);ctx.lineTo(x+Math.cos(a)*l,y+Math.sin(a)*l);ctx.stroke();}}else if(style==='pro'){for(let i=0;i<d.length;i+=4){d[i]=clamp(curve(d[i]));d[i+1]=clamp(curve(d[i+1]));d[i+2]=clamp(curve(d[i+2]));}ctx.putImageData(img,0,0);const gr=ctx.createLinearGradient(0,0,cvs.width,cvs.height);gr.addColorStop(0,'rgba(255,255,255,0.03)');gr.addColorStop(1,'rgba(0,0,0,0.03)');ctx.fillStyle=gr;ctx.fillRect(0,0,cvs.width,cvs.height);}}
        function curve(v){const n=v/255;return(n<0.5?2*n*n:1-Math.pow(-2*n+2,2)/2)*255;}function clamp(v){return Math.max(0,Math.min(255,Math.round(v)));}
        window.addTextBlock=()=>{const block={id:'text-'+Date.now(),text:document.getElementById('textInput').value||'Your Text Here',x:50,y:30,font:document.getElementById('fontSelect').value,size:textSize,color:document.getElementById('textColor').value,bold:isBold,italic:isItalic};textBlocks.push(block);renderTextBlocks();updateWorkflow(3);toast('Text added! Drag to position.');};
        function renderTextBlocks(){const layer=document.getElementById('textLayer');layer.innerHTML='';layer.style.pointerEvents='auto';textBlocks.forEach(b=>{const el=document.createElement('div');el.className='text-block';el.id=b.id;el.textContent=b.text;el.style.cssText='left:'+b.x+'%;top:'+b.y+'%;font-family:'+b.font+';font-size:'+b.size+'px;color:'+b.color+';font-weight:'+(b.bold?'bold':'normal')+';font-style:'+(b.italic?'italic':'normal');el.onmousedown=function(e){e.preventDefault();selectedTextBlock=b;document.querySelectorAll('.text-block').forEach(x=>x.classList.remove('selected'));el.classList.add('selected');const rect=layer.getBoundingClientRect(),sx=e.clientX,sy=e.clientY,sl=b.x,st=b.y;function mv(e){b.x=Math.max(0,Math.min(90,sl+((e.clientX-sx)/rect.width)*100));b.y=Math.max(0,Math.min(90,st+((e.clientY-sy)/rect.height)*100));el.style.left=b.x+'%';el.style.top=b.y+'%';}function up(){document.removeEventListener('mousemove',mv);document.removeEventListener('mouseup',up);}document.addEventListener('mousemove',mv);document.addEventListener('mouseup',up);};layer.appendChild(el);});}
        window.updateTextStyle=()=>{if(!selectedTextBlock)return;selectedTextBlock.font=document.getElementById('fontSelect').value;selectedTextBlock.color=document.getElementById('textColor').value;renderTextBlocks();};
        window.toggleBold=()=>{isBold=!isBold;document.getElementById('boldBtn').classList.toggle('active',isBold);if(selectedTextBlock){selectedTextBlock.bold=isBold;renderTextBlocks();}};
        window.toggleItalic=()=>{isItalic=!isItalic;document.getElementById('italicBtn').classList.toggle('active',isItalic);if(selectedTextBlock){selectedTextBlock.italic=isItalic;renderTextBlocks();}};
        window.changeTextSize=d=>{textSize=Math.max(10,Math.min(72,textSize+d));document.getElementById('textSizeDisplay').textContent=textSize+'px';if(selectedTextBlock){selectedTextBlock.size=textSize;renderTextBlocks();}};
        window.flipCard=()=>{document.getElementById('cardPreview').classList.toggle('flipped');};
        window.downloadCard=()=>{const exp=document.createElement('canvas');exp.width=800;exp.height=1120;const ex=exp.getContext('2d');ex.drawImage(previewCanvas,0,0,800,1120);textBlocks.forEach(b=>{ex.font=(b.italic?'italic ':'')+(b.bold?'bold ':'')+(b.size*2)+'px '+b.font;ex.fillStyle=b.color;ex.fillText(b.text,(b.x/100)*800,(b.y/100)*1120+b.size*2);});ex.font='14px Arial';ex.fillStyle='rgba(0,0,0,0.3)';ex.fillText('Made with Chameleon Studios‚Ñ¢',560,1100);const link=document.createElement('a');link.download='chameleon-card-'+Date.now()+'.png';link.href=exp.toDataURL('image/png');link.click();updateWorkflow(4);toast('Card downloaded!');};
        window.saveCard=()=>{savedCards.push({id:Date.now(),type:selectedCardType,style:selectedStyle,texture:selectedTexture,image:previewCanvas.toDataURL('image/png'),texts:[...textBlocks],date:new Date().toLocaleDateString()});try{localStorage.setItem('chameleon_cards',JSON.stringify(savedCards));}catch(e){}renderSaved();toast('üíæ Card saved!');};
        function loadSaved(){try{const d=localStorage.getItem('chameleon_cards');if(d){savedCards=JSON.parse(d);renderSaved();}}catch(e){savedCards=[];}}
        function renderSaved(){const grid=document.getElementById('savedGrid');if(!savedCards.length){grid.innerHTML='<div style="grid-column:1/-1;text-align:center;padding:60px 20px;background:var(--card);border-radius:var(--radius-xl);"><div style="font-size:64px;margin-bottom:16px;opacity:0.4">ü¶é</div><h3>No Saved Cards</h3><p style="color:var(--text-muted)">Create your first card!</p></div>';return;}grid.innerHTML=savedCards.map(c=>{const t=CARD_TYPES.find(x=>x.id===c.type)||{icon:'üé®',name:'Custom'};return'<div class="gallery-card" onclick="loadSavedCard('+c.id+')"><div class="gallery-card-image"><img src="'+c.image+'"></div><div class="gallery-card-info"><div class="gallery-card-title">'+t.icon+' '+t.name+'</div><div class="gallery-card-meta">'+c.date+' ‚Ä¢ '+c.style+'</div></div></div>';}).join('');}
        window.loadSavedCard=id=>{const c=savedCards.find(x=>x.id===id);if(!c)return;const img=new Image();img.onload=()=>{previewCtx.drawImage(img,0,0,previewCanvas.width,previewCanvas.height);};img.src=c.image;textBlocks=[...c.texts];renderTextBlocks();selectedCardType=c.type;selectedStyle=c.style;selectedTexture=c.texture;showSection('create');toast('Card loaded!');};
        function initTemplates(){const temps=[{type:'birthday',title:'Classic Birthday',style:'comic'},{type:'birthday',title:'Elegant Birthday',style:'pro'},{type:'wedding',title:'Romantic Wedding',style:'sketch'},{type:'wedding',title:'Modern Wedding',style:'pro'},{type:'thankyou',title:'Simple Thanks',style:'sketch'},{type:'thankyou',title:'Floral Thanks',style:'outdoor'},{type:'invite',title:'Party Invite',style:'comic'},{type:'invite',title:'Formal Invite',style:'pro'}];document.getElementById('templatesGrid').innerHTML=temps.map(t=>{const tp=CARD_TYPES.find(x=>x.id===t.type);return'<div class="gallery-card" data-type="'+t.type+'" onclick="useTemplate(\''+t.type+'\',\''+t.style+'\')"><div class="gallery-card-image" style="background:linear-gradient(135deg,'+tp.color+'22,'+tp.color+'44);display:flex;align-items:center;justify-content:center;"><span style="font-size:64px;opacity:0.6">'+tp.icon+'</span></div><div class="gallery-card-info"><div class="gallery-card-title">'+t.title+'</div><div class="gallery-card-meta">'+t.style+' style</div></div></div>';}).join('');document.querySelectorAll('.filter-btn').forEach(btn=>{btn.onclick=function(){document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));this.classList.add('active');const f=this.dataset.filter;document.querySelectorAll('#templatesGrid .gallery-card').forEach(c=>{c.style.display=(f==='all'||c.dataset.type===f)?'block':'none';});};});}
        window.useTemplate=(t,s)=>{selectedCardType=t;selectedStyle=s;document.querySelectorAll('.card-type').forEach(c=>c.classList.toggle('active',c.dataset.type===t));document.querySelectorAll('.style-option').forEach(o=>o.classList.toggle('active',o.dataset.style===s));showSection('create');toast('Template selected! Now draw.');};
        function updateWorkflow(step){for(let i=1;i<=4;i++){const el=document.getElementById('step'+i);el.classList.remove('active','done');if(i<step)el.classList.add('done');else if(i===step)el.classList.add('active');}}
        window.showSection=id=>{document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));document.getElementById('section-'+id).classList.add('active');document.querySelectorAll('.nav-tab').forEach(t=>t.classList.toggle('active',t.dataset.section===id));};
        window.toast=(msg,err)=>{const t=document.getElementById('toast');t.textContent=msg;t.className='toast'+(err?' error':'');t.classList.add('show');setTimeout(()=>t.classList.remove('show'),3000);};
        window.addEventListener('resize',()=>{if(!hasDrawn)initCanvas();});
    })();
    </script>
</body>
</html>
